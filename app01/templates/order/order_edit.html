{% extends "layout.html" %}

{% block content %}
<br>
<div class="container">
    <ul class="list-group">
        <li class="list-group-item list-group-item-dark">
            <strong>编辑订单</strong>
        </li>
        <li class="list-group-item">
            <form method="post">
                {% csrf_token %}

                <div class="mb-3">
                    <label class="form-label"><strong>订单号（不可修改）</strong></label>
                    <input type="text" class="form-control" name="oid" value="{{ order.oid }}" disabled>
                </div>

                <div class="mb-3">
                    <label class="form-label"><strong>标题</strong></label>
                    <input type="text" class="form-control" name="title" value="{{ order.title }}">
                </div>

                <div class="mb-3">
                    <label class="form-label"><strong>价格</strong></label>
                    <input type="number" step="0.01" class="form-control" name="price" value="{{ order.price }}">
                </div>

                <div class="mb-3">
                    <label class="form-label"><strong>用户</strong></label>
                    <select class="form-select" name="user_id">
                        {% for user in users %}
                            <option value="{{ user.user_id }}"
                                {% if user.user_id == order.user.user_id %}selected{% endif %}>
                                {{ user.name }}（{{ user.user_id }}）
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label"><strong>排片</strong></label>
                    <select class="form-select" name="schedule_id">
                        {% for schedule in schedules %}
                            <option value="{{ schedule.schedule_id }}"
                                {% if schedule.schedule_id == order.schedule.schedule_id %}selected{% endif %}>
                                {{ schedule.movie.title }} - {{ schedule.hall.name }} - {{ schedule.show_time|date:"Y-m-d H:i" }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label"><strong>座位</strong></label>
                    <select class="form-select" name="seat_id">
                        {% for seat in seats %}
                            <option value="{{ seat.seat_id }}"
                                {% if seat.seat_id == order.seat.seat_id %}selected{% endif %}>
                                {{ seat.seat_number }}（{{ seat.get_status_display }}, {{ seat.hall.name }}）
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label"><strong>状态</strong></label>
                    <select class="form-select" name="status">
                        <option value="1" {% if order.status == 1 %}selected{% endif %}>待支付</option>
                        <option value="2" {% if order.status == 2 %}selected{% endif %}>支付中</option>
                        <option value="3" {% if order.status == 3 %}selected{% endif %}>已支付</option>
                    </select>
                </div>

                <div style="margin: 10px">
                    <button type="submit" class="btn btn-success">保存修改</button>
                    <a href="/order/list" class="btn btn-secondary">返回</a>
                </div>
            </form>
        </li>
    </ul>
</div>
{% endblock %}
